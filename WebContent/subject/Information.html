<!DOCTYPE html>
<html>
<head lang="en">
<meta charset="UTF-8">
<meta name="viewport"
	content="width=device-width,initial-scale=1,user-scalable=0">
<meta name="viewport"
	content="width=device-width, initial-scale=1.0, minimum-scale=0.5, maximum-scale=2.0, user-scalable=no,minimal-ui" />
<link rel="stylesheet" href="../css/dist/style/weui.min.css" />
<link rel="stylesheet" href="../css/bootstrap.min.css" />
<link rel="stylesheet" href="../css/Information.css" />
<link rel="stylesheet" type="text/css" href="../css/tcal.css" />

<title>基本信息</title>
</head>
<body>
	<div class="container">
		<header>
			<div
				class="information_header col-lg-12 col-xs-12 col-md-12 col-sm-12">
				<ul>
					<li id="li1"
						class="information_header_li active col-lg-3 col-xs-3 col-md-3 col-sm-3">基本信息</li>
					<li id="li2"
						class="information_header_li col-lg-3 col-xs-3 col-md-3 col-sm-3">生活方式</li>
					<li id="li3"
						class="information_header_li col-lg-3 col-xs-3 col-md-3 col-sm-3">疾病信息</li>
					<li id="li4"
						class="information_header_li col-lg-3 col-xs-3 col-md-3 col-sm-3">关心的人</li>
				</ul>
			</div>
		</header>
		<div class="content col-lg-12 col-xs-12 col-md-12 col-sm-12">
			<!--<div class="Care">-->
			<!--<div class="Care_one col-lg-12 col-xs-12 col-md-12 col-sm-12">-->
			<!--<div class="Care_img col-lg-3 col-xs-3 col-md-3 col-sm-3">-->
			<!--<img src="../images/head_portrait.jpg" alt=""/>-->
			<!--</div>-->
			<!--<span class="col-lg-9 col-xs-9 col-md-9 col-sm-9">用户名</span>-->
			<!--</div>-->
			<!--<div class="Care_one col-lg-12 col-xs-12 col-md-12 col-sm-12">-->
			<!--<div class="Care_img col-lg-3 col-xs-3 col-md-3 col-sm-3">-->
			<!--<img src="../images/head_portrait.jpg" alt=""/>-->
			<!--</div>-->
			<!--<span class="col-lg-9 col-xs-9 col-md-9 col-sm-9">用户名</span>-->
			<!--</div>-->
			<!--</div>-->
			<!--<div class="button_sp_area">-->
			<!--<a href="#"  class="add weui_btn_plain_primary">添加</a>-->
			<!--</div>-->
		</div>
		<div class="footer col-lg-12 col-xs-12 col-md-12 col-sm-12">
			 <a href="guide.html" class=" TJ_guide col-lg-4 col-xs-4 col-md-4 col-sm-4">
	        	<img class="TJ_guide_img " src="../images/TJ_guide.png" alt=""/>
	        	<span>体检指南</span>
        	</a>
	        <a href="myhealth.html" class="My_health col-lg-4 col-xs-4 col-md-4 col-sm-4">
	     		<img class="My_health_img " src="../images/My_health.png" alt=""/>
	        	<span>我的健康</span>
	        </a>
	        <a href="Message.html" class="my_message col-lg-4 col-xs-4 col-md-4 col-sm-4">
	        	<img class="my_message_img " src="../images/my_message.png" alt=""/>
	        	<span>我的信息</span>
	       	</a>
		</div>
	</div>
</body>
<!--<script type="text/javascript" src="../js/tcal.js"></script>-->
<script type="text/javascript" src="../js/jquery-1.7.2.min.js"></script>

<script type="text/javascript" src="../js/City.js"></script>
<script type="text/javascript" src="../js/message.js"></script>
<script type="text/javascript" src="../My97DatePicker/WdatePicker.js"></script>
<script type="text/javascript" src="../js/content.js"></script>
<!--cookie-->
<script type="text/javascript" src="../js/public.js"></script>
<script type="text/javascript">
	$(document).ready(
			function() {
				function ReadCookie(cookieName) {
					var theCookie = "" + document.cookie;
					var ind = theCookie.indexOf(cookieName);
					if (ind == -1 || cookieName == "")
						return "";
					var ind1 = theCookie.indexOf(';', ind);
					if (ind1 == -1)
						ind1 = theCookie.length;
					/*读取Cookie值*/
					return unescape(theCookie.substring(ind + cookieName.length
							+ 1, ind1));
				}
				var userId = ReadCookie("userId");

				jibenxinxi(userId);
				  $('.my_message_img ').attr("src", "../images/my_message_1.png");
			        $('.my_message span').css('color','rgb(126, 200, 136)');
				//liv();
			});
	
	function jibenxinxi(userId){
		//用户基本信息
		$.ajax({
			type : "post",
			url : "http://localhost:8080/ihealth/rest/findUserById",
			contentType : "application/json;charset=utf8",
			data : JSON.stringify({
				"userId" : userId
			}),
			dataType : "json",
			success : function(r) {
				if (r.result == "success") {
					var data = eval(r.data);
					var sex = data.SEX;//获取性别
					$('#username').val(data.NAME);//获取姓名
					$("#user_id").val(data.USER_ID);
					$("option[value='m0']").text(data.MARRIAGESTATUS);//获取婚姻状况
					//                  $("#pro option:selected").text(data.);//获取出生地
					$("#city option:selected").text(data.BIRTHPLACE);
					//                  $("#pro1 option:selected").text(data.);//获取常住地
					$("#city1 option:selected").text(data.LIVEPLACE);
					$("#s1 option:selected").text(data.CAREER);//获取职业
					$("#s2 option:selected").text(data.DEGREE);//获取学历
					$('.Wdate').val(data.BIRTHDAY);//获取生日
					$('.height').val(data.HEIGHT);//获取身高
					$('.weigth').val(data.WEIGHT);//获取体重
					console.log(sex)
					if (sex == '女') {
						$('#girl').attr("checked", "true");
						$('#boy').removeAttr("checked");

					} else if (sex == '男') {
						$('#boy').attr("checked", "true");
						$('#girl').removeAttr("checked");
					}
				}
			}

		});
		
	}

	function on_click() { //基本信息
		var userId = $("#user_id").val();
		//liv();
		var Height = $('.height').val();
		var Weigth = $('.weigth').val();
		var Username = $('#username').val();
		//      if(Height!=''&& Weigth!=''&&Username!=''){
		//
		//      }
		//if(Height!=''&& Weigth!=''&&Username!=''){
		//	console.log(userId);
		msgsave(userId);//基本信息保存

		tagCategory(userId);
		//}
		$("#li2").addClass('active');
		$("#li1").removeClass('active');
	}

	
	//获取生活方式
	function tagCategory(userId) {
		$.ajax({
					url : 'http://localhost:8080/ihealth/resttag/listAllTagCategory',
					type : 'post',
					success : function(r) {
						var data = eval(r.data);
						if (r.success == 'success') {
							var str = "";

							for (var i = 0; i < data.length; i++) {
								
								if(data[i].ISEXCLUSIVE == '1'){
									str += "<div class='ddiv col-lg-12 col-xs-12 col-md-12 col-sm-12' id='ddiv"
										+ (i + 1)
										+ "' onclick='duoliv(\"ddiv"+(i+1)+"\")'>"
										+ "<span class='col-lg-3 col-xs-3 col-md-3 col-sm-3' >"
										+ data[i].NAME + "</span>" + "</div>";
								}else if(data[i].ISEXCLUSIVE == '0'){
									str += "<div class='ddiv col-lg-12 col-xs-12 col-md-12 col-sm-12' id='ddiv"
										+ (i + 1)
										+ "' onclick='liv(\"ddiv"+(i+1)+"\")'>"
										+ "<span class='col-lg-3 col-xs-3 col-md-3 col-sm-3' >"
										+ data[i].NAME + "</span>" + "</div>";
								}
							}
							str += "<div class='message_next2  col-lg-12 col-xs-12 col-md-12 col-sm-12'>"
									+ "<p style=\"display: block\">"
									+ "<a href=\"#\" class=\"message_next_a2 weui_btn weui_btn_plain_primary\" onclick='on_click2(\""+userId+"\")'>下一步</a>"
									+ "</p>" + "</div>";
							$('.content').html(str);

							$.ajax({
								url : 'http://localhost:8080/ihealth/resttag/listAllTagByUserID',
								type : 'post',
								contentType : "application/json;charset=utf8",
								data : JSON
										.stringify({
											"userID" : userId
										}),
								dataType : "json",
								async : false,
								cache : false,
								success : function(ur) {
									var urd = eval(ur.data);
									for (var j = 0; j < data.length; j++) {
										$.ajax({
											url : 'http://localhost:8080/ihealth/resttag/listAllTagByTagCategoryID',
											type : 'post',
											contentType : "application/json;charset=utf8",
											data : JSON
													.stringify({
														"tagCategory_ID" : data[j].TAGCATEGORY_ID
													}),
											dataType : "json",
											async : false,
											cache : false,
											success : function(d) {
												if (d.msg = "success") {
													var data1 = eval(d.data);
													var str1 = "<ul class='liveul col-lg-9 col-xs-9 col-md-9 col-sm-9'>";
													for (var a = 0; a < data1.length; a++) {
														str1+="<li "
														if(urd!=undefined){
															for(var b =0;b<urd.length;b++){
																if(data1[a].TAG_ID == urd[b].TAG_ID){
																	str1 += "class='livefs'"
																}
															}
														}
														
														str1+=">"+ data1[a].NAME
														+ "<input type='hidden' value='"+data1[a].TAG_ID+"'/></li>";
													}
													str1 += "</ul>";
													$("#ddiv" + (j + 1))
															.append(str1);
													
												}
											}
										});

							}
								}
							});

							
						}
					}
				});
	}
</script>
</html>